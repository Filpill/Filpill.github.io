<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Building Data Pipelines With Python: Systems Perspective | Filip Livancic</title>
<meta name="keywords" content="python, sql, powerpoint, outlook, excel, automation, programming">
<meta name="description" content="Summary I&rsquo;m always suprised by organisations which are not investing resources into automating their processes.
Yes, large organisations are complex and sprawling in nature. However, I am always spotting oppertunities to streamline processes and alleviate the burden from our day to day work.
This article serves as an example for the wide ranging applications I&rsquo;ve been using Python to automate both simple and complex tasks with high efficiency.
An Idealistic Data Processing System These are the ideal goals we are trying to achieve:">
<meta name="author" content="">
<link rel="canonical" href="https://filpill.github.io/projects/data_system/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.003c9d079ab327c0f4d881effa9b0c186b47f63444823d6eff1ad4bc669c1611.css" integrity="sha256-ADydB5qzJ8D02IHv&#43;psMGGtH9jREgj1u/xrUvGacFhE=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://filpill.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://filpill.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://filpill.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://filpill.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://filpill.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Building Data Pipelines With Python: Systems Perspective" />
<meta property="og:description" content="Summary I&rsquo;m always suprised by organisations which are not investing resources into automating their processes.
Yes, large organisations are complex and sprawling in nature. However, I am always spotting oppertunities to streamline processes and alleviate the burden from our day to day work.
This article serves as an example for the wide ranging applications I&rsquo;ve been using Python to automate both simple and complex tasks with high efficiency.
An Idealistic Data Processing System These are the ideal goals we are trying to achieve:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://filpill.github.io/projects/data_system/" />
<meta property="og:image" content="https://filpill.github.io/img/auto/python_all_auto.png" /><meta property="article:section" content="projects" />
<meta property="article:published_time" content="2022-07-23T21:12:42&#43;01:00" />
<meta property="article:modified_time" content="2022-07-23T21:12:42&#43;01:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://filpill.github.io/img/auto/python_all_auto.png" />
<meta name="twitter:title" content="Building Data Pipelines With Python: Systems Perspective"/>
<meta name="twitter:description" content="Summary I&rsquo;m always suprised by organisations which are not investing resources into automating their processes.
Yes, large organisations are complex and sprawling in nature. However, I am always spotting oppertunities to streamline processes and alleviate the burden from our day to day work.
This article serves as an example for the wide ranging applications I&rsquo;ve been using Python to automate both simple and complex tasks with high efficiency.
An Idealistic Data Processing System These are the ideal goals we are trying to achieve:"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "List of Projects",
      "item": "https://filpill.github.io/projects/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Building Data Pipelines With Python: Systems Perspective",
      "item": "https://filpill.github.io/projects/data_system/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Building Data Pipelines With Python: Systems Perspective",
  "name": "Building Data Pipelines With Python: Systems Perspective",
  "description": "Summary I\u0026rsquo;m always suprised by organisations which are not investing resources into automating their processes.\nYes, large organisations are complex and sprawling in nature. However, I am always spotting oppertunities to streamline processes and alleviate the burden from our day to day work.\nThis article serves as an example for the wide ranging applications I\u0026rsquo;ve been using Python to automate both simple and complex tasks with high efficiency.\nAn Idealistic Data Processing System These are the ideal goals we are trying to achieve:",
  "keywords": [
    "python", "sql", "powerpoint", "outlook", "excel", "automation", "programming"
  ],
  "articleBody": "Summary I’m always suprised by organisations which are not investing resources into automating their processes.\nYes, large organisations are complex and sprawling in nature. However, I am always spotting oppertunities to streamline processes and alleviate the burden from our day to day work.\nThis article serves as an example for the wide ranging applications I’ve been using Python to automate both simple and complex tasks with high efficiency.\nAn Idealistic Data Processing System These are the ideal goals we are trying to achieve:\nTo build complete end-to-end solutions from source to user. We want to minimise manual intervention during the data processing. Build tools which are adaptable according to buisness needs. Here is a very high level view of a system of data pipelines I’ve built in the past: %%{init: {'theme': 'forest', 'themeVariables': {'darkMode':'true'}}}%% graph TD; subgraph Data Processing and Manipulation A[Shell Scripts]-- terminal/\ncli tools --\u003eB(Core Driver:\nPython Scripts) C[(SQL Server)]-- pyodbc --\u003eB end subgraph Data Products B-- xlsxwriter --\u003eD(Excel Dashboards) B-- python-pptx --\u003eE(Powerpoint Presentations) B-- smtplib --\u003eF(Emails via SMTP) end This is by no means a definative method and sometimes we can’t get away from 100% of tedious tasks. However, this is just the result of incremental upgrades made across the board to optimise my processes in the past. I’ve had a lot of success inter-weaving these tools together purely through experimentation of various python libraries available.\nAs long as the tools are well written, you can bridge them across to new processes easily and maintain them with little to no effort. Not to mention the hunderds to thousands of hours being saved as you execute these processes..\nThe idea is not to replicate this system one-to-one, but to inspire a systems level appreciation for connecting automation tools togther in a well thought out manner.\nPyODBC - A SQL Interface For Python The most important setup of the automation process is the data ingestion into Python.\nFortunately for myself, our organisation hosts several Microsoft SQL Servers which form our data source.\nPyODBC is a python module which enables the capability to authenticate and connect directly to your desired SQL server. The great thing is that you can copy an entire query written in SQL and paste it into a triple quote string of a python script. The module will be able to interpret the string as a SQL query.\nMuch of the pyodbc set-up can be universalised because realistically you only need two inputs: the server name and the sql query. Therefore I have developed a sql utility written in an independant python file which can be imported into any script.\nXlsxWriter - Excel Report Generator For Python There is a reason why Excel reigns as a supreme data communication tool. It’s proliferation as a standard piece of software. There is no office computer in the world that is not supplied with Excel.\nSure, we could be using BI tools to communicate and share data. However, this completely depends on the company budget and how much the organisation can stretch the licensing to individuals.\nOk, so we deciding to work inside the Excel ecosystem as it will not incur any extra overhead.\nHowever, we don’t want to be doing our analysis in Excel…Why? Because it’s extremely computationally expensive to handle medium to large data sets. And its next useless when stringing together lots of complex formulas with the large data size.\nSo how can we solve this issue? Simple. XlsxWriter.\nXlsxWriter is a python module which allows you to create fresh Excel reports from scratch with analysis performed on Python. Essentially you can turn all your pandas tables Excel table objects. All your matplotlib charts can be inserted into the workbook for the visualisation. Furthermore, with a bit more effort, you can easily turn it into a dashboard.\nNow it can be easily share amongst the stakeholders. I’ve been using this tool many a time to get excel boards out quickly with python.\nNote: XlsxWriter as the name suggests “writes Excel Workbooks”. To be clear, this is not an API that can directly interact with objects in existing workbooks. Everytime you run a script with xlsxwriter tools involved, a completely new file will be producing and overwrite the previous one.\nPython-Pptx - PowerPoint Presentation Generator For Python How many hundreds of hours do you waste making powerpoints? Probably too many. Though this is a big target for automation if the slide content is very standardised across different periods of time.\nI’ve tried automating them with markdown tools. However, I run into a lot of issues where I do not have full control over the position of the objects. Stakeholders tend to ask for extra features or to move shapes around the slide. Thats where python-pptx comes in.\nInstead of letting markdown dictate all the default positions of your powerpoint shapes. I’ve been automating all my presentations with Python-pptx.\nSince the control of the objects is very granular its important to set up some functions to standardise some layouts or shapes you want to insert. This speeds up the scripting process as usually slides tend to have a lot of the same code and all we need to do is change some parameters.\nThe powerpoint functions I write are imported from a seperate .py file. The reason we ideally want a global function file is that we can share these python function to any script where we are automating presentations.\nNote: Python-pptx works in similar fashion to xlsxwriter. Everytime the script in run, a brand new presentation file will be build from sratch. We are not interacting with existing pptx objects on existing presentations.\nSmtplib - Email Automation with Python For those routine emails that you send on a recurring basis you able to automate the process using the python library smtplib.\nWe can borrow the SMTP protocol to send our emails and we don’t necessarily need to be tied to our GUI standard email environment. We can use python as the interface and send emails without gmail or outlook.\nThe script that is being generated can have a message template built inside itself. Additonally can make a list of tuples containing the addresses and attachments you want to send to the respective parties.\n",
  "wordCount" : "1036",
  "inLanguage": "en",
  "image":"https://filpill.github.io/img/auto/python_all_auto.png","datePublished": "2022-07-23T21:12:42+01:00",
  "dateModified": "2022-07-23T21:12:42+01:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://filpill.github.io/projects/data_system/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Filip Livancic",
    "logo": {
      "@type": "ImageObject",
      "url": "https://filpill.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>mermaid.initialize({ startOnLoad: true, securityLevel: 'loose'}});</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://filpill.github.io/" accesskey="h" title="Filip Livancic (Alt + H)">Filip Livancic</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://filpill.github.io/profile/" title="Profile">
                    <span>Profile</span>
                </a>
            </li>
            <li>
                <a href="https://filpill.github.io/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="https://filpill.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://filpill.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://filpill.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://filpill.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://filpill.github.io/projects/">List of Projects</a></div>
    <h1 class="post-title">
      Building Data Pipelines With Python: Systems Perspective<sup><span class="entry-isdraft">&nbsp;&nbsp;[draft]</span></sup>
    </h1>
    <div class="post-meta"><span title='2022-07-23 21:12:42 +0100 BST'>July 23, 2022</span>

</div>
  </header> 
<figure class="entry-cover"><img loading="lazy" src="https://filpill.github.io/img/auto/python_all_auto.png" alt="Python Automating Everything">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#summary" aria-label="Summary">Summary</a></li>
                <li>
                    <a href="#an-idealistic-data-processing-system" aria-label="An Idealistic Data Processing System">An Idealistic Data Processing System</a><ul>
                        
                <li>
                    <a href="#pyodbc---a-sql-interface-for-python" aria-label="PyODBC - A SQL Interface For Python">PyODBC - A SQL Interface For Python</a></li>
                <li>
                    <a href="#xlsxwriter---excel-report-generator-for-python" aria-label="XlsxWriter - Excel Report Generator For Python">XlsxWriter - Excel Report Generator For Python</a></li>
                <li>
                    <a href="#python-pptx---powerpoint-presentation-generator-for-python" aria-label="Python-Pptx - PowerPoint Presentation Generator For Python">Python-Pptx - PowerPoint Presentation Generator For Python</a></li>
                <li>
                    <a href="#smtplib---email-automation-with-python" aria-label="Smtplib - Email Automation with Python">Smtplib - Email Automation with Python</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="summary">Summary<a hidden class="anchor" aria-hidden="true" href="#summary">#</a></h1>
<p>I&rsquo;m always suprised by organisations which are not investing resources into automating their processes.</p>
<p>Yes, large organisations are complex and sprawling in nature. However, I am always spotting oppertunities to streamline processes and alleviate the burden from our day to day work.</p>
<p>This article serves as an example for the wide ranging applications I&rsquo;ve been using Python to automate both simple and complex tasks with high efficiency.</p>
<h1 id="an-idealistic-data-processing-system">An Idealistic Data Processing System<a hidden class="anchor" aria-hidden="true" href="#an-idealistic-data-processing-system">#</a></h1>
<p>These are the ideal goals we are trying to achieve:</p>
<ul>
<li>To build complete end-to-end solutions from source to user.</li>
<li>We want to minimise manual intervention during the data processing.</li>
<li>Build tools which are adaptable according to buisness needs.</li>
</ul>
<p>Here is a very high level view of a system of data pipelines I&rsquo;ve built in the past:
<div style="text-align:center;">
	<div class="mermaid">
		%%{init: {'theme': 'forest', 'themeVariables': {'darkMode':'true'}}}%%
	  
graph TD;
    subgraph <br><br><br>&nbsp; Data Processing <br>and Manipulation
    A[Shell Scripts]-- terminal/<br>cli tools -->B(Core Driver:<br> Python Scripts)
    C[(SQL Server)]-- pyodbc -->B
    end
    subgraph Data Products
    B-- xlsxwriter -->D(Excel Dashboards)
    B-- python-pptx -->E(Powerpoint Presentations)
    B-- smtplib -->F(Emails via SMTP)
    end

	</div>
</div>
</p>
<p>This is by no means a definative method and sometimes we can&rsquo;t get away from 100% of tedious tasks. However, this is just the result of incremental upgrades made across the board to optimise my processes in the past. I&rsquo;ve had a lot of success inter-weaving these tools together purely through experimentation of various python libraries available.</p>
<p>As long as the tools are well written, you can bridge them across to new processes easily and maintain them with little to no effort. Not to mention the hunderds to thousands of hours being saved as you execute these processes..</p>
<p>The idea is not to replicate this system one-to-one, but to inspire a systems level appreciation for connecting automation tools togther in a well thought out manner.</p>
<h2 id="pyodbc---a-sql-interface-for-python">PyODBC - A SQL Interface For Python<a hidden class="anchor" aria-hidden="true" href="#pyodbc---a-sql-interface-for-python">#</a></h2>
<p><img loading="lazy" src="/img/logo/sql.png#center" alt="SQL"  />
</p>
<p>The most important setup of the automation process is the data ingestion into Python.</p>
<p>Fortunately for myself, our organisation hosts several Microsoft SQL Servers which form our data source.</p>
<p>PyODBC is a python module which enables the capability to authenticate and connect directly to your desired SQL server. The great thing is that you can copy an entire query written in SQL and paste it into a triple quote string of a python script. The module will be able to interpret the string as a SQL query.</p>
<p>Much of the pyodbc set-up can be universalised because realistically you only need two inputs: the server name and the sql query. Therefore I have developed a sql utility written in an independant python file which can be imported into any script.</p>
<h2 id="xlsxwriter---excel-report-generator-for-python">XlsxWriter - Excel Report Generator For Python<a hidden class="anchor" aria-hidden="true" href="#xlsxwriter---excel-report-generator-for-python">#</a></h2>
<p><img loading="lazy" src="/img/logo/excel.jpg#center" alt="Excel"  />
</p>
<p>There is a reason why Excel reigns as a supreme data communication tool. It&rsquo;s proliferation as a standard piece of software. There is no office computer in the world that is not supplied with Excel.</p>
<p>Sure, we could be using BI tools to communicate and share data. However, this completely depends on the company budget and how much the organisation can stretch the licensing to individuals.</p>
<p>Ok, so we deciding to work inside the Excel ecosystem as it will not incur any extra overhead.</p>
<p>However, we don&rsquo;t want to be doing our analysis in Excel&hellip;Why? Because it&rsquo;s extremely computationally expensive to handle medium to large data sets. And its next useless when stringing together lots of complex formulas with the large data size.</p>
<p>So how can we solve this issue? Simple. XlsxWriter.</p>
<p>XlsxWriter is a python module which allows you to create fresh Excel reports from scratch with analysis performed on Python. Essentially you can turn all your pandas tables Excel table objects. All your matplotlib charts can be inserted into the workbook for the visualisation. Furthermore, with a bit more effort, you can easily turn it into a dashboard.</p>
<p>Now it can be easily share amongst the stakeholders. I&rsquo;ve been using this tool many a time to get excel boards out quickly with python.</p>
<p><em><strong>Note:</strong> XlsxWriter as the name suggests &ldquo;writes Excel Workbooks&rdquo;. To be clear, this is not an API that can directly interact with objects in existing workbooks. Everytime you run a script with xlsxwriter tools involved, a completely new file will be producing and overwrite the previous one.</em></p>
<h2 id="python-pptx---powerpoint-presentation-generator-for-python">Python-Pptx - PowerPoint Presentation Generator For Python<a hidden class="anchor" aria-hidden="true" href="#python-pptx---powerpoint-presentation-generator-for-python">#</a></h2>
<p><img loading="lazy" src="/img/logo/pptx.png#center" alt="Powerpoint"  />
</p>
<p>How many hundreds of hours do you waste making powerpoints? Probably too many. Though this is a big target for automation if the slide content is very standardised across different periods of time.</p>
<p>I&rsquo;ve tried automating them with markdown tools. However, I run into a lot of issues where I do not have full control over the position of the objects. Stakeholders tend to ask for extra features or to move shapes around the slide. Thats where python-pptx comes in.</p>
<p>Instead of letting markdown dictate all the default positions of your powerpoint shapes. I&rsquo;ve been automating all my presentations with Python-pptx.</p>
<p>Since the control of the objects is very granular its important to set up some functions to standardise some layouts or shapes you want to insert. This speeds up the scripting process as usually slides tend to have a lot of the same code and all we need to do is change some parameters.</p>
<p>The powerpoint functions I write are imported from a seperate .py file. The reason we ideally want a global function file is that we can share these python function to any script where we are automating presentations.</p>
<p><em><strong>Note:</strong> Python-pptx works in similar fashion to xlsxwriter. Everytime the script in run, a brand new presentation file will be build from sratch. We are not interacting with existing pptx objects on existing presentations.</em></p>
<h2 id="smtplib---email-automation-with-python">Smtplib - Email Automation with Python<a hidden class="anchor" aria-hidden="true" href="#smtplib---email-automation-with-python">#</a></h2>
<p><img loading="lazy" src="/img/logo/outlook.png#center" alt="Outlook"  />
</p>
<p>For those routine emails that you send on a recurring basis you able to automate the process using the python library smtplib.</p>
<p>We can borrow the SMTP protocol to send our emails and we don&rsquo;t necessarily need to be tied to our GUI standard email environment. We can use python as the interface and send emails without gmail or outlook.</p>
<p>The script that is being generated can have a message template built inside itself. Additonally can make a list of tuples containing the addresses and attachments you want to send to the respective parties.</p>



  </div>


  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://filpill.github.io/tags/python/">python</a></li>
      <li><a href="https://filpill.github.io/tags/sql/">sql</a></li>
      <li><a href="https://filpill.github.io/tags/powerpoint/">powerpoint</a></li>
      <li><a href="https://filpill.github.io/tags/outlook/">outlook</a></li>
      <li><a href="https://filpill.github.io/tags/excel/">excel</a></li>
      <li><a href="https://filpill.github.io/tags/automation/">automation</a></li>
      <li><a href="https://filpill.github.io/tags/programming/">programming</a></li>
    </ul>
<nav class="paginav">
  <a class="next" href="https://filpill.github.io/projects/github/">
    <span class="title">Next »</span>
    <br>
    <span>Github - Command Line Interface Procedures</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://filpill.github.io/">Filip Livancic</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
